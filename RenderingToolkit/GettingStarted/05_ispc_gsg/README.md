# Getting Started Sample for Intel&reg; oneAPI Rendering Toolkit (Render Kit): Intel&reg; Implicit SPMD Program Compiler (Intel&reg; ISPC)

The Intel&reg; Implicit SPMD Program Compiler (Intel&reg; ISPC) optimizes single
program, multiple data kernels for execution on modern SIMD hardware. Intel&reg;
ISPC is often used with high performing Intel&reg; Embree and Intel&reg; Open
Volume Kernel Library (IntelÂ® Open VKL) based programs. Intel&reg; ISPC compiles
a C programming language variant, and the language includes helpful constructs
for modern parallelism. This sample introduces Intel&reg; ISPC within the scope
of the Intel&reg; oneAPI Rendering Toolkit (Render Kit).

| Minimum Requirements              | Description
|:---                               |:---
| OS                                | Linux*Ubuntu* 18.04 <br>CentOS*8 (or compatible) <br> Windows* 10 <br>macOS* 10.15+
| Hardware                          | Intel 64 Penryn or newer with SSE4.1 extensions; or an ARM64 with NEON extensions <br>(Optimized requirements: Intel 64 Skylake or newer with AVX512 extensions; or ARM64 with NEON extensions)
| Compiler Toolchain                | Windows*OS: MSVS 2019 installed with Windows* SDK and CMake*; Other platforms: C++11 compiler and CMake*
| Libraries                         | Install Intel&reg; oneAPI Rendering Toolkit (Render Kit), including the Intel&reg; Implicit SPMD Program Compiler

| Objective                         | Description
|:---                               |:---
| What you will learn               | How to build and run a basic Intel&reg; ISPC program using the Render Kit distribution.
| Time to complete                  | 5 minutes

## Purpose

This getting started sample highlights three key basic parts to using Intel&reg;
ISPC.

1) Using the Intel&reg; ISPC kernel, `simple`.
2) Linking the kernel into a final program.
3) Demonstrating vector hardware extension targeting.

The `simple` kernel, defined in `simple.ispc`, performs an element-wise
operation on an input float array. The output is written to stdout.

## Key Implementation Details

### The Kernel and Linking (1 and 2)

- The sample programs have the main entry point defined in `simple.cpp`. Compile
  this source to an object with a C++ compiler.
- `simple.ispc` contains the implementation of the kernel function. This source
  is compiled to an object by the Intel ISPC compiler driver `ispc`.
- The final program is links the C++ object to the Intel&reg; ISPC object.
- Within the C++ source, the function prototype for the kernel is introduced by
  way of this preprocessor code:

```
#include "simple_ispc.h"
```

- **Note**: The `simple_ispc.h` header file is generated by the `ispc` compiler
  driver when it compiles `simple.ispc`.

### Single and Multitargeting (3)

This sample demonstrates both single device and automatic, multiple devices
targeting. Two output programs are built respectively, and they emit the same
output.

- The first build target program, `simple`, builds with the `simple.ispc` kernel
  targeted to SSE2 (Streaming SIMD Extensions 2) ISA extensions. These
  extensions were introduced on CPUs in the early 2000s.
- The second build target program, `simple_multi`, creates an object per ISA
  extension target, as well as a primary kernel linking object. All objects are
  linked to generate the final binary. The program will runtime detect the
  appropriate codepath for the target platform.

This initial sample demonstrates Intel&reg; ISPC usage with an introductory
program running on CPU only. Other Intel&reg; Embree and Intel&reg; Open VKL
sample programs demonstrate usage of Intel&reg; ISPC in conjuction with those
libraries. See more about programming using Intel&reg; ISPC by reading the
[documentation](https://ispc.github.io/documentation.html).

### Targeting Documentation

- To target ISA extension capability introduced in newer x86_64 processors, see
  the [targeting
  table](https://ispc.github.io/ispc.html#selecting-the-compilation-target) in
  the Intel&reg; ISPC User's Guide.
- For targeting ARM64 with NEON extensions, see the [targeting
  table](https://ispc.github.io/ispc.html#selecting-the-compilation-target) in
  the Intel&reg; ISPC User's Guide, and edit the CMakeLists.txt file accordingly
  for the build step.

## Build and Run

### Windows

1. Run a new **x64 Native Tools Command Prompt for MSVS 2019**.

```
call <path-to-oneapi-folder>\setvars.bat
cd <path-to-oneAPI-samples>\RenderingToolkit\GettingStarted\05_ispc_gsg
mkdir build
cd build
cmake ..
cmake --build . --config Release
cd Release
.\simple.exe
.\simple_multi.exe
```

2. Review the output emitted to standard out.

### Linux and macOS

1. Start a new Terminal session.

```
source <path-to-oneapi-folder>/setvars.sh
cd <path-to-oneAPI-samples>/RenderingToolkit/GettingStarted/05_ispc_gsg
mkdir build
cd build
cmake ..
cmake --build .
./simple
./simple_multi
```

2. Review the output emitted to standard out.

## License

This code sample is licensed under a BSD-3-Clause license. See
[LICENSE.txt](LICENSE.txt) for details.

Third party program Licenses can be found here:
[third-party-programs.txt](https://github.com/oneapi-src/oneAPI-samples/blob/master/third-party-programs.txt).