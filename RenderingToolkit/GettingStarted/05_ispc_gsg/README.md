# Getting Started Sample for Intel oneAPI Rendering Toolkit: Intel Implicit SPMD Program Compiler


Intel Implicit SPMD Program Compiler (ISPC) optimizes single program multiple data kernels for execution on modern SIMD hardware. ISPC is often used in conjunction with high performing Embree and OpenVKL based programs. ISPC compiles a C programming language variant. The language has helpful constructs for modern parallelism. This sample introduces Intel ISPC within the scope of the Intel oneAPI Rendering Toolkit (Render Kit).

| Minimum Requirements              | Description
|:---                               |:---
| OS                                | Linux* Ubuntu* 18.04, CentOS* 8 (or compatible); Windows* 10; MacOS* 10.15+
| Hardware                          | Intel 64 Penryn or newer with SSE4.1 extensions; or an ARM64 with NEON extensions
| Compiler Toolchain                | Windows* OS: MSVS 2019 installed with Windows* SDK and CMake*; Other platforms: C++11 compiler and CMake*
| Libraries                         | Install Render Kit including Intel Implicit SPMD Program Compiler

| Optimized Requirements            | Description
| :---                              | :---
| Hardware                          | Intel 64 Skylake or newer with AVX512 extensions; or ARM64 with NEON extensions

| Objective                         | Description
|:---                               |:---
| What you will learn               | How to build and run a basic Intel ISPC program using the Render Kit distribution.
| Time to complete                  | 5 minutes


## Purpose

This getting started sample highlights three key basic parts to using Intel ISPC.
1) the Intel ISPC kernel, `simple`.
2) kernel linking into a final program
3) vector hardware extension targeting capability


The `simple` kernel, defined in `simple.ispc`, performs an element wise operation on an input float array. The output is written to stdout.


## Key Implementation Details

### The Kernel and Linking (1 and 2)

- Our sample programs have the main entry point defined in `simple.cpp`. We compile this source to an object with a C++ compiler.
- `simple.ispc` contains the implementation of the kernel function. This source is compiled to an object by the Intel ISPC compiler driver `ispc`.
- The final program is links the C++ object to the Intel ISPC object.
- Within the C++ source, the function prototype for the kernel is introduced by way of this preprocessor code:
```
#include "simple_ispc.h"
```

- Key: The simple_ispc.h header file is generated by the `ispc` compiler driver when it compiles simple.ispc.

### Single and Multitargeting (3)

In this sample, we demonstrate both single and automatic multiple device targeting. Two output programs are built respectively they emit the same output.

- The first build target program, `simple`, builds with the simple.ispc kernel targeted to SSE2 (Streaming SIMD Extensions 2) ISA extensions. These extensions were introduced on CPUs in the early 2000's.
- The second build target program, `simple_multi`, will create an object per ISA extension target, as well as a primary kernel linking object. All objects are then linked to generate the final binary. The program will runtime detect the appropriate codepath for the target platform.

This initial sample demonstrates Intel ISPC usage with an introductory program running on CPU only. Other Intel Embree and Intel Open VKL sample programs demonstrate usage of ISPC in conjuction with those libraries.
See more about programming with Intel ISPC with the [documentation](https://ispc.github.io/documentation.html).

### Targeting Documentation

- To target ISA extension capability introduced in newer x86_64 processors, see the [targeting table](https://ispc.github.io/ispc.html#selecting-the-compilation-target) in the release notes.
- For targeting ARM64 with NEON extensions. See the [target selection](https://ispc.github.io/ispc.html#selecting-the-compilation-target) in the release notes. Edit the CMakeLists.txt file accordingly for the build step.
- For targeting Intel Graphics Processors, see the article for [ISPC on Gen](https://ispc.github.io/ispc_for_gen.html).

## License

This code sample is licensed under a BSD-3-Clause license. See
[LICENSE.txt](LICENSE.txt) for details.

Third party program Licenses can be found here: [third-party-programs.txt](https://github.com/oneapi-src/oneAPI-samples/blob/master/third-party-programs.txt)

## Build and Run


### Windows OS:


Run a new **x64 Native Tools Command Prompt for MSVS 2019**

```
call <path-to-oneapi-folder>\setvars.bat
cd <path-to-oneAPI-samples>\RenderingToolkit\GettingStarted\05_ispc_gsg
mkdir build
cd build
cmake ..
cmake --build . --config Release
cd Release
.\simple.exe
.\simple_multi.exe
```

Review the output emitted to standard out.


### Linux OS:

Start a new Terminal session
```
source <path-to-oneapi-folder>/setvars.sh
cd <path-to-oneAPI-samples>/RenderingToolkit/GettingStarted/05_ispc_gsg
mkdir build
cd build
cmake ..
cmake --build .
./simple
./simple_multi
```

Review the output emitted to standard out.

### MacOS:

Start a new Terminal session

```
source <path-to-oneapi-folder>/setvars.sh
cd <path-to-oneAPI-samples>/RenderingToolkit/GettingStarted/05_ispc_gsg
mkdir build
cd build
cmake ..
cmake --build .
./simple
./simple_multi
```

Review the output emitted to standard out.
